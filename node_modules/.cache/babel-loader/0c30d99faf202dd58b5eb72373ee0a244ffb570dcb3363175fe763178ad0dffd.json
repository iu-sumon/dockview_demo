{"ast":null,"code":"import React from 'react';\nimport { createGridview, PROPERTY_KEYS_GRIDVIEW } from 'dockview-core';\nimport { ReactGridPanelView } from './view';\nimport { usePortalsLifecycle } from '../react';\nfunction extractCoreOptions(props) {\n  const coreOptions = PROPERTY_KEYS_GRIDVIEW.reduce((obj, key) => {\n    if (key in props) {\n      obj[key] = props[key];\n    }\n    return obj;\n  }, {});\n  return coreOptions;\n}\nexport const GridviewReact = React.forwardRef((props, ref) => {\n  const domRef = React.useRef(null);\n  const gridviewRef = React.useRef();\n  const [portals, addPortal] = usePortalsLifecycle();\n  React.useImperativeHandle(ref, () => domRef.current, []);\n  const prevProps = React.useRef({});\n  React.useEffect(() => {\n    const changes = {};\n    PROPERTY_KEYS_GRIDVIEW.forEach(propKey => {\n      const key = propKey;\n      const propValue = props[key];\n      if (key in props && propValue !== prevProps.current[key]) {\n        changes[key] = propValue;\n      }\n    });\n    if (gridviewRef.current) {\n      gridviewRef.current.updateOptions(changes);\n    } else {\n      // not yet fully initialized\n    }\n    prevProps.current = props;\n  }, PROPERTY_KEYS_GRIDVIEW.map(key => props[key]));\n  React.useEffect(() => {\n    if (!domRef.current) {\n      return () => {\n        // noop\n      };\n    }\n    const frameworkOptions = {\n      createComponent: options => {\n        return new ReactGridPanelView(options.id, options.name, props.components[options.name], {\n          addPortal\n        });\n      }\n    };\n    const api = createGridview(domRef.current, Object.assign(Object.assign({}, extractCoreOptions(props)), frameworkOptions));\n    const {\n      clientWidth,\n      clientHeight\n    } = domRef.current;\n    api.layout(clientWidth, clientHeight);\n    if (props.onReady) {\n      props.onReady({\n        api\n      });\n    }\n    gridviewRef.current = api;\n    return () => {\n      gridviewRef.current = undefined;\n      api.dispose();\n    };\n  }, []);\n  React.useEffect(() => {\n    if (!gridviewRef.current) {\n      return;\n    }\n    gridviewRef.current.updateOptions({\n      createComponent: options => {\n        return new ReactGridPanelView(options.id, options.name, props.components[options.name], {\n          addPortal\n        });\n      }\n    });\n  }, [props.components]);\n  return React.createElement(\"div\", {\n    style: {\n      height: '100%',\n      width: '100%'\n    },\n    ref: domRef\n  }, portals);\n});\nGridviewReact.displayName = 'GridviewComponent';","map":{"version":3,"names":["React","createGridview","PROPERTY_KEYS_GRIDVIEW","ReactGridPanelView","usePortalsLifecycle","extractCoreOptions","props","coreOptions","reduce","obj","key","GridviewReact","forwardRef","ref","domRef","useRef","gridviewRef","portals","addPortal","useImperativeHandle","current","prevProps","useEffect","changes","forEach","propKey","propValue","updateOptions","map","frameworkOptions","createComponent","options","id","name","components","api","Object","assign","clientWidth","clientHeight","layout","onReady","undefined","dispose","createElement","style","height","width","displayName"],"sources":["E:/dockview.demo/node_modules/dockview/dist/esm/gridview/gridview.js"],"sourcesContent":["import React from 'react';\nimport { createGridview, PROPERTY_KEYS_GRIDVIEW, } from 'dockview-core';\nimport { ReactGridPanelView } from './view';\nimport { usePortalsLifecycle } from '../react';\nfunction extractCoreOptions(props) {\n    const coreOptions = PROPERTY_KEYS_GRIDVIEW.reduce((obj, key) => {\n        if (key in props) {\n            obj[key] = props[key];\n        }\n        return obj;\n    }, {});\n    return coreOptions;\n}\nexport const GridviewReact = React.forwardRef((props, ref) => {\n    const domRef = React.useRef(null);\n    const gridviewRef = React.useRef();\n    const [portals, addPortal] = usePortalsLifecycle();\n    React.useImperativeHandle(ref, () => domRef.current, []);\n    const prevProps = React.useRef({});\n    React.useEffect(() => {\n        const changes = {};\n        PROPERTY_KEYS_GRIDVIEW.forEach((propKey) => {\n            const key = propKey;\n            const propValue = props[key];\n            if (key in props && propValue !== prevProps.current[key]) {\n                changes[key] = propValue;\n            }\n        });\n        if (gridviewRef.current) {\n            gridviewRef.current.updateOptions(changes);\n        }\n        else {\n            // not yet fully initialized\n        }\n        prevProps.current = props;\n    }, PROPERTY_KEYS_GRIDVIEW.map((key) => props[key]));\n    React.useEffect(() => {\n        if (!domRef.current) {\n            return () => {\n                // noop\n            };\n        }\n        const frameworkOptions = {\n            createComponent: (options) => {\n                return new ReactGridPanelView(options.id, options.name, props.components[options.name], { addPortal });\n            },\n        };\n        const api = createGridview(domRef.current, Object.assign(Object.assign({}, extractCoreOptions(props)), frameworkOptions));\n        const { clientWidth, clientHeight } = domRef.current;\n        api.layout(clientWidth, clientHeight);\n        if (props.onReady) {\n            props.onReady({ api });\n        }\n        gridviewRef.current = api;\n        return () => {\n            gridviewRef.current = undefined;\n            api.dispose();\n        };\n    }, []);\n    React.useEffect(() => {\n        if (!gridviewRef.current) {\n            return;\n        }\n        gridviewRef.current.updateOptions({\n            createComponent: (options) => {\n                return new ReactGridPanelView(options.id, options.name, props.components[options.name], { addPortal });\n            },\n        });\n    }, [props.components]);\n    return (React.createElement(\"div\", { style: { height: '100%', width: '100%' }, ref: domRef }, portals));\n});\nGridviewReact.displayName = 'GridviewComponent';\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}